<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rocket Tool - Realtime Stock Prices</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body{font-family:Inter,system-ui,Arial,sans-serif;background:#fafafa;margin:0;color:#0f172a}
    .wrap{max-width:800px;margin:20px auto;padding:18px}
    .card{background:#fff;border-radius:12px;padding:20px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
    header{display:flex;justify-content:space-between;align-items:center}
    select,button{padding:8px 10px;border:1px solid #e2e8f0;border-radius:8px}
    .price{font-size:32px;font-weight:700;margin-top:10px}
    .change{font-size:14px;margin-top:5px}
    footer{margin-top:20px;color:#64748b;font-size:13px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <h2>✨ Rocket Tool — ราคาหุ้นเรียลไทม์</h2>
        <div>
          <select id="stockSelect">
            <option value="RBRK">RBRK</option>
            <option value="AAPL">AAPL</option>
            <option value="MSFT">MSFT</option>
            <option value="TSLA">TSLA</option>
          </select>
          <button id="refreshBtn">โหลดข้อมูล</button>
        </div>
      </header>

      <div id="output">
        <div class="price" id="price">—</div>
        <div class="change" id="change">รอโหลดข้อมูล...</div>
      </div>

      <footer>
        ดึงข้อมูลเรียลไทม์จาก <strong>Alpha Vantage</strong> ด้วย API Key จริงของคุณ<br>
        หมายเหตุ: จำกัด 25 ครั้งต่อนาที (หากเกินระบบจะชะลอการตอบกลับ)
      </footer>
    </div>
  </div>

  <script>
    const API_KEY = "4F4NRBC1I6SEAE4W";
    const select = document.getElementById("stockSelect");
    const btn = document.getElementById("refreshBtn");
    const priceEl = document.getElementById("price");
    const changeEl = document.getElementById("change");

    async function fetchRealtime(symbol) {
      const url = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbol}&apikey=${API_KEY}`;
      const res = await fetch(url);
      const data = await res.json();
      if (!data["Global Quote"]) throw new Error("ไม่พบข้อมูลจาก API");

      const q = data["Global Quote"];
      const price = parseFloat(q["05. price"]);
      const change = parseFloat(q["09. change"]);
      const percent = parseFloat(q["10. change percent"]);

      return { price, change, percent };
    }

    async function updateData() {
      const symbol = select.value;
      priceEl.textContent = "กำลังโหลด...";
      changeEl.textContent = "";
      btn.disabled = true;
      try {
        const d = await fetchRealtime(symbol);
        priceEl.textContent = `${symbol} : $${d.price.toFixed(2)}`;
        const sign = d.change >= 0 ? "+" : "";
        changeEl.style.color = d.change >= 0 ? "#16a34a" : "#dc2626";
        changeEl.textContent = `${sign}${d.change.toFixed(2)} (${sign}${d.percent.toFixed(2)}%)`;
      } catch (e) {
        priceEl.textContent = "เกิดข้อผิดพลาด";
        changeEl.textContent = e.message;
      }
      btn.disabled = false;
    }

    btn.addEventListener("click", updateData);
    updateData(); // โหลดอัตโนมัติครั้งแรก
  </script>
</body>
</html>
