<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üöÄ Rocket Tool - Real-Time Stock Viewer</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: "Prompt", sans-serif;
      background: #0a0a0a;
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #00ffcc;
    }
    input {
      padding: 10px;
      font-size: 16px;
      border-radius: 10px;
      margin-bottom: 15px;
      width: 250px;
      text-align: center;
      border: 1px solid #00ffcc;
      background: #111;
      color: #00ffcc;
    }
    #chartContainer {
      width: 95%;
      max-width: 900px;
      margin: 0 auto;
      background: #111;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0, 255, 204, 0.3);
    }
    .info {
      margin-top: 15px;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <h1>üöÄ Rocket Tool</h1>
  <p>Real-Time Stock Viewer + ‡πÅ‡∏ô‡∏ß‡∏£‡∏±‡∏ö‡πÅ‡∏ô‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>

  <input id="symbolInput" type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏∏‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô AAPL, TSLA, SOFI..." />
  <div id="chartContainer">
    <canvas id="stockChart"></canvas>
  </div>
  <div class="info" id="info"></div>

  <script>
    const apiKey = "4F4NRBC1I6SEAE4W";
    const ctx = document.getElementById("stockChart").getContext("2d");
    let chart;

    document.getElementById("symbolInput").addEventListener("change", () => {
      const symbol = document.getElementById("symbolInput").value.trim().toUpperCase();
      if (symbol) fetchData(symbol);
    });

    async function fetchData(symbol) {
      document.getElementById("info").innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
      try {
        const res = await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${symbol}&apikey=${apiKey}`);
        const data = await res.json();
        const timeSeries = data["Time Series (Daily)"];
        if (!timeSeries) throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏∏‡πâ‡∏ô");

        const dates = Object.keys(timeSeries).slice(0, 30).reverse();
        const prices = dates.map(d => parseFloat(timeSeries[d]["4. close"]));
        const highs = dates.map(d => parseFloat(timeSeries[d]["2. high"]));
        const lows = dates.map(d => parseFloat(timeSeries[d]["3. low"]));

        const sup1 = average(lows.slice(-5));
        const res1 = average(highs.slice(-5));
        const sup2 = Math.min(...lows);
        const res2 = Math.max(...highs);

        updateChart(symbol, dates, prices, [sup1, sup2], [res1, res2]);
        const lastPrice = prices[prices.length - 1];
        document.getElementById("info").innerHTML = `
          üìà <b>${symbol}</b> ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span style="color:#00ffcc">${lastPrice.toFixed(2)}</span><br>
          üü© ‡πÅ‡∏ô‡∏ß‡∏£‡∏±‡∏ö: ${sup1.toFixed(2)} / ${sup2.toFixed(2)}<br>
          üü• ‡πÅ‡∏ô‡∏ß‡∏ï‡πâ‡∏≤‡∏ô: ${res1.toFixed(2)} / ${res2.toFixed(2)}
        `;
      } catch (e) {
        document.getElementById("info").innerText = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + e.message;
      }
    }

    function average(arr) {
      return arr.reduce((a, b) => a + b, 0) / arr.length;
    }

    function updateChart(symbol, labels, prices, supports, resistances) {
      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: "line",
        data: {
          labels,
          datasets: [
            {
              label: `${symbol} (‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏¥‡∏î)`,
              data: prices,
              borderColor: "#00ffcc",
              tension: 0.2,
            },
            {
              label: "‡πÅ‡∏ô‡∏ß‡∏£‡∏±‡∏ö",
              data: Array(prices.length).fill(supports[0]),
              borderColor: "#00cc66",
              borderDash: [5, 5],
              pointRadius: 0,
            },
            {
              label: "‡πÅ‡∏ô‡∏ß‡∏£‡∏±‡∏ö‡∏•‡∏∂‡∏Å",
              data: Array(prices.length).fill(supports[1]),
              borderColor: "#009944",
              borderDash: [5, 5],
              pointRadius: 0,
            },
            {
              label: "‡πÅ‡∏ô‡∏ß‡∏ï‡πâ‡∏≤‡∏ô",
              data: Array(prices.length).fill(resistances[0]),
              borderColor: "#ff3333",
              borderDash: [5, 5],
              pointRadius: 0,
            },
            {
              label: "‡πÅ‡∏ô‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î",
              data: Array(prices.length).fill(resistances[1]),
              borderColor: "#cc0000",
              borderDash: [5, 5],
              pointRadius: 0,
            }
          ],
        },
        options: {
          responsive: true,
          scales: {
            x: { ticks: { color: "#ccc" } },
            y: { ticks: { color: "#ccc" } },
          },
          plugins: {
            legend: {
              labels: { color: "#fff" },
            },
          },
        },
      });
    }
  </script>
</body>
</html>
